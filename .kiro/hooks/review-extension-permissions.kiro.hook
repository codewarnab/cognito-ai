{
  "enabled": true,
  "name": "Review Extension Permissions",
  "description": "Reviews the Chrome extension permissions declared in package.json manifest section and checks if each permission is actually used in the codebase. Flags any unused permissions that could be removed.",
  "version": "1",
  "when": {
    "type": "userTriggered"
  },
  "then": {
    "type": "askAgent",
    "prompt": "Review the Chrome extension permissions in package.json under the \"manifest\" section. For each permission listed in \"permissions\" and \"host_permissions\":\n\n1. Read the package.json file to extract all declared permissions\n2. Search the codebase (especially in src/) for actual usage of each permission:\n   - \"tabs\" â†’ chrome.tabs API usage\n   - \"storage\" â†’ chrome.storage API usage\n   - \"activeTab\" â†’ active tab access patterns\n   - \"scripting\" â†’ chrome.scripting API usage\n   - \"sidePanel\" â†’ chrome.sidePanel API usage\n   - \"contextMenus\" â†’ chrome.contextMenus API usage\n   - \"notifications\" â†’ chrome.notifications API usage\n   - \"bookmarks\" â†’ chrome.bookmarks API usage\n   - \"history\" â†’ chrome.history API usage\n   - \"alarms\" â†’ chrome.alarms API usage\n   - \"offscreen\" â†’ chrome.offscreen API usage\n   - \"identity\" â†’ chrome.identity API usage\n   - Host permissions â†’ fetch/XMLHttpRequest to those domains\n\n3. Create a report listing:\n   - âœ… Used permissions (with file locations where they're used)\n   - âš ï¸ Potentially unused permissions (no usage found)\n   - ğŸ’¡ Recommendations for permission cleanup\n\nFocus on identifying permissions that can be safely removed to improve extension security and user trust."
  }
}